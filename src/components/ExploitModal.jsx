import { useEffect, useState } from "react";

export default function ExploitModal({ onComplete }) {
  const [progress, setProgress] = useState(0);

  useEffect(() => {
    const timer = setInterval(() => {
      setProgress((prev) => {
        if (prev >= 100) {
          clearInterval(timer);
          setTimeout(onComplete, 2000); // transition after Fatal Error
          return 100;
        }
        return prev + 5;
      });
    }, 120);
    return () => clearInterval(timer);
  }, [onComplete]);

  return (
    <div className="fixed inset-0 bg-black bg-opacity-90 z-50 flex flex-col items-center justify-center text-white font-mono">
      {progress < 100 ? (
        <>
          <div className="text-green-400 text-xl mb-4">Installing payload...</div>
          <div className="w-64 bg-gray-800 border border-green-400 rounded">
            <div
              className="bg-green-500 h-4 transition-all"
              style={{ width: `${progress}%` }}
            />
          </div>
          <div className="mt-2 text-sm text-green-300">{progress}%</div>
        </>
      ) : (
        <div className="text-3xl text-red-500 animate-pulse">FATAL ERROR</div>
      )}
    </div>
  );
}
